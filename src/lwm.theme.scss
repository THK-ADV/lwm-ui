// Custom Theming for Angular Material
// For more information: https://material.angular.io/guide/theming
@import "@angular/material/theming";
@import "lwm.theme.config";

// Include mat-core globally once (typography will be handled in the theme mixin)
@include mat-core();

// Removed individual component theme mixins - now using angular-material-theme() to avoid duplicates

@function lwm-light-theme($primary, $accent, $warn, $foreground: (), $background: ()) {
  @return (
          primary: mat-palette(palette-from($primary)),
          accent: mat-palette(palette-from($accent)),
          warn: mat-palette(palette-from($warn)),
          is-dark: false,
          foreground: map-merge($mat-light-theme-foreground, $foreground),
          background: map-merge($mat-light-theme-background, $background)
  );
}

@function lwm-typography-config(
  $font-family: '"Helvetica Neue", "Ostrich Sans", sans-serif',
  $display-4: mat-typography-level(112px, 112px, 300),
  $display-3: mat-typography-level(56px, 56px, 400),
  $display-2: mat-typography-level(45px, 48px, 400),
  $display-1: mat-typography-level(34px, 40px, 400),
  $headline: mat-typography-level(24px, 32px, 400),
  $title: mat-typography-level(20px, 32px, 500),
  $subheading-2: mat-typography-level(16px, 28px, 400),
  $subheading-1: mat-typography-level(15px, 24px, 400),
  $body-2: mat-typography-level(14px, 24px, 500),
  $body-1: mat-typography-level(14px, 20px, 400),
  $caption: mat-typography-level(12px, 20px, 400),
  $button: mat-typography-level(14px, 14px, 500),
  $input: mat-typography-level(inherit, 1.125, 400)
) {
  @return mat-typography-config(
                  $font-family,
                  $display-4,
                  $display-3,
                  $display-2,
                  $display-1,
                  $headline,
                  $title,
                  $subheading-2,
                  $subheading-1,
                  $body-2,
                  $body-1,
                  $caption,
                  $button,
                  $input
  );
}

// Custom styles mixin that contains all LWM-specific customizations
@mixin lwm-custom-styles($theme) {
  // Button customizations
  button.mat-stroked-button.mat-primary {
    border: 2px lighten($th-magenta, 40) solid;
    margin-right: $small-spacing;
  }

  button.mat-stroked-button.mat-accent {
    border: 2px lighten($th-orange, 40) solid;
    margin-right: $small-spacing;
  }

  button.mat-stroked-button.mat-warn {
    border: 2px lighten($th-red, 40) solid;
    margin-right: $small-spacing;
  }

  // Button toggle customizations
  $failed-col: #ff4500;
  $neutral-col: #888;
  $passed-col: #32cd32;
  $bg-col: #c0c0c0;
  .toggle-group.mat-button-toggle-group-appearance-standard {
    border: none;

    .mat-button-toggle-label-content {
      line-height: 2.5em !important;
      padding: 0 7px !important;
    }

    i {
      font-size: 1.5em;
    }

    .mat-button-toggle {
      border: none;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      margin: 0px 0 8px 0;
      padding: 0;
      background-color: $bg-col;
      color: white;
    }

    .mat-button-toggle.failed {
      border-top-left-radius: 5px;
      border-bottom-left-radius: 5px;
    }

    .mat-button-toggle.passed {
      border-top-right-radius: 5px;
      border-bottom-right-radius: 5px;
    }

    .mat-button-toggle-checked.failed {
      background-color: $failed-col;
    }

    .mat-button-toggle-checked.neutral {
      background-color: $neutral-col;
    }

    .mat-button-toggle-checked.passed {
      background-color: $passed-col;
    }
  }

  // Card customizations
  .mat-card {
    margin: $low-spacing 0 $med-spacing 0;
    padding: 0 !important;
    -webkit-box-shadow: none !important;
    box-shadow: none !important;

    mat-card-content {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-align: start;
      -ms-flex-align: start;
      align-items: flex-start;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      margin: 0;
      padding: 0;

      mat-form-field:not(:first-child) {
        margin: 0;
        margin-left: $h-spacing;
      }
    }

    .mat-card-actions {
      margin: 0;
      padding: 0;

      button {
        width: 100%;
      }
    }
  }

  // Chips customizations
  $height: 32px;
  $fontSize: 14px;

  mat-basic-chip {
    display: inline-block;
    padding: 0 12px;
    border-radius: $height;
    height: $height;
    line-height: $height;
    font-size: $fontSize;
    margin: 0 5px;
  }

  mat-basic-chip.primary {
    background-color: $th-magenta;
    color: white;
  }

  mat-basic-chip.accent {
    background-color: $th-orange;
    color: white;
  }

  // Dialog customizations
  h1.mat-dialog-title {
    font-size: 2em;
  }

  h2.mat-dialog-title {
    font-size: 1.5em;
  }

  .mat-form-field {
    width: 100%;
    margin-bottom: 20px;
  }

  .mat-form-field-infix {
    margin-top: 20px;
  }

  mat-dialog-container {
    .mat-form-field-ripple {
      background-color: $th-magenta !important;
    }

    app-user-edit-dialog .mat-dialog-actions,
    app-delete-dialog .mat-dialog-actions,
    app-create-update-dialog .mat-dialog-actions,
    lwm-group-edit .mat-dialog-actions,
    lwm-course-authority-dialog .mat-dialog-actions,
    lwm-timetable-entry .mat-dialog-actions,
    lwm-group-preview-modal .mat-dialog-actions,
    lwm-confirm-dialog .mat-dialog-actions,
    lwm-decision-dialog .mat-dialog-actions,
    lwm-reschedule .mat-dialog-actions,
    lwm-annotation .mat-dialog-actions,
    lwm-student-create-application .mat-dialog-actions,
    lwm-assignment-entry-takeover-dialog .mat-dialog-actions {
      background-color: $ivory;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: end;
      -ms-flex-align: end;
      align-items: flex-end;
      -webkit-box-pack: end;
      -ms-flex-pack: end;
      justify-content: flex-end;
      margin: $med-spacing $med-spacing * (-1);
      margin-bottom: $med-spacing * (-1);
      padding-right: $med-spacing;

      button {
        margin: $med-spacing 0 $med-spacing $low-spacing;
      }
    }
  }

  // Form field customizations
  .reportcard-bonus {
    max-width: 100px !important;
  }

  // Icon customizations
  .material-icons.mat-14 {
    font-size: 14px;
  }

  .material-icons.mat-18 {
    font-size: 18px;
  }

  .material-icons.mat-24 {
    font-size: 24px;
  }

  .material-icons.mat-36 {
    font-size: 36px;
  }

  .material-icons.mat-48 {
    font-size: 48px;
  }

  // Paginator customizations
  .mat-paginator {
    margin-bottom: $high-spacing;
  }

  // Sidenav customizations
  .mat-drawer-container {
    background-color: transparent !important;
  }
  .mat-drawer {
    background-color: mat-color(map-get(map-get($theme, overlay), background), dialog);
    color: mat-color(map-get(map-get($theme, overlay), foreground), text);
    @include all-component-colors(map-get($theme, overlay));
  }

  // Table customizations
  table {
    width: 100%;
    margin-bottom: $high-spacing;
    border-collapse: initial;

    td.mat-cell,
    th.mat-cell,
    td.mat-header-cell,
    th.mat-header-cell {
      padding: $low-spacing $med-spacing;
      min-width: 60px;
      word-wrap: initial;
    }

    td.mat-cell,
    th.mat-cell {
      vertical-align: text-top;
      padding: $low-spacing $med-spacing;
      min-width: 60px;
      word-wrap: initial;
    }
  }

  .mat-row:hover {
    background-color: $hover-color;
    cursor: pointer;
  }
}

@mixin lwm-theme(
  $main-theme,
  $overlay-theme,
  $app-bg-1: #303030,
  $app-bg-2: #303030,
  $typography: lwm-typography-config()
) {
  $theme: (
          main: $main-theme,
          overlay: $overlay-theme,
          app-bg-1: $app-bg-1,
          app-bg-2: $app-bg-2,
  );

  // Include typography configuration
  @include angular-material-typography($typography);

  // Use the modern Angular Material theming API to avoid duplicates
  @include angular-material-theme(map-get($theme, main));

  // Include custom component styles that extend Angular Material
  @include lwm-custom-styles($theme);
}

//.lwm-base-theme {
@include lwm-theme(
                lwm-light-theme($primary: $th-magenta, $accent: $th-orange, $warn: $th-red),
                lwm-light-theme($primary: $th-magenta, $accent: $th-orange, $warn: $th-red),
                $ivory,
                $ivory,
                lwm-typography-config()
);
