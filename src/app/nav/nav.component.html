<div
  *ngIf="authorities"
  class="lwm-container"
  [class.lwm-is-mobile]="mobileQuery.matches">
  <mat-toolbar color="primary" class="lwm-toolbar">
    <button mat-icon-button (click)="snav.toggle()">
      <mat-icon>menu</mat-icon>
    </button>
    <lwm-search
      *ngIf="moduleAuthorities.length"
      [auths]="moduleAuthorities"></lwm-search>
    <span class="example-spacer"></span>
  </mat-toolbar>

  <mat-sidenav-container
    class="lwm-sidenav-container"
    [style.marginTop.px]="mobileQuery.matches ? 56 : 0">
    <mat-sidenav #snav mode="side">
      <div id="sidebar-meta" routerLink="">
        <div id="sidebar-bubble">
          <h4>{{ initials }}</h4>
        </div>
        <div id="sidebar-nickname">
          <span>&#64;{{ user.systemId }}</span>
        </div>
        <div id="sidebar-user">{{ user.firstname }} {{ user.lastname }}</div>
      </div>

      <mat-accordion class="navListContainer" displayMode="flat" multi="true">
        <!-- Module Section -->
        <mat-expansion-panel *ngIf="hasModuleAuthorities" class="nav-panel module-panel" [expanded]="modulePanelOpen" (opened)="togglePanelState('module', true)" (closed)="togglePanelState('module', false)">
          <mat-expansion-panel-header class="sidebarHeader moduleHeader">
            <mat-panel-title>
              <mat-icon>account_balance</mat-icon>
              <span>Module</span>
            </mat-panel-title>
            <mat-panel-description>
              <mat-icon>{{ modulePanelOpen ? 'expand_less' : 'expand_more' }}</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <mat-nav-list>
            <a
              mat-list-item
              routerLink="e/courses/{{ auth.course.id }}"
              *ngFor="let auth of moduleAuthorities"
              routerLinkActive="list-item-active"
            >{{ auth.course.abbreviation }} ({{auth.course.lecturer.lastname}})</a>
          </mat-nav-list>
        </mat-expansion-panel>

        <!-- Configuration Section -->
        <mat-expansion-panel *ngIf="isAdmin" class="nav-panel config-panel" [expanded]="configPanelOpen" (opened)="togglePanelState('config', true)" (closed)="togglePanelState('config', false)">
          <mat-expansion-panel-header class="sidebarHeader configHeader">
            <mat-panel-title>
              <mat-icon>build</mat-icon>
              <span>Konfiguration</span>
            </mat-panel-title>
            <mat-panel-description>
              <mat-icon>{{ configPanelOpen ? 'expand_less' : 'expand_more' }}</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <mat-nav-list>
            <a
              mat-list-item
              routerLink="e/{{ config.path }}"
              *ngFor="let config of configs"
              routerLinkActive="list-item-active"
            >{{ config.label }}</a>
          </mat-nav-list>
        </mat-expansion-panel>

        <!-- Miscellaneous Section -->
        <mat-expansion-panel class="nav-panel misc-panel" [expanded]="miscPanelOpen" (opened)="togglePanelState('misc', true)" (closed)="togglePanelState('misc', false)">
          <mat-expansion-panel-header class="sidebarHeader miscHeader">
            <mat-panel-title>
              <mat-icon>info</mat-icon>
              <span>Sonstiges</span>
            </mat-panel-title>
            <mat-panel-description>
              <mat-icon class="material-symbols-outlined">
                {{ miscPanelOpen ? 'expand_less' : 'expand_more' }}</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <mat-nav-list>
            <a
              *ngFor="let link of miscLinks"
              (click)="openLink(link)"
              mat-list-item
              routerLinkActive="list-item-active">
              {{ link.label }}
            </a>
          </mat-nav-list>
        </mat-expansion-panel>

        <!-- Logout Button in Mat-List-Style -->
        <h3 mat-subheader class="sidebarHeader logoutHeader" (click)="logout()">
          <mat-icon>power_settings_new</mat-icon>
          <span>Ausloggen</span>
        </h3>
      </mat-accordion>
    </mat-sidenav>
    <mat-sidenav-content>
      <ng-content></ng-content>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
